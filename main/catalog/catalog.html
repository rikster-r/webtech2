<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Catalog - Egoisty</title>

    <!-- Bootstrap -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    
    <!-- Font Awesome -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
    />

    <!-- Apply saved theme -->
    <script src="../../global-theme.js"></script>

    <link rel="stylesheet" href="../../global.css" />
    <link href="catalog.css" rel="stylesheet" />

    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>

    <style>
      /* üîç Custom search styling */
      .search-bar input {
        border-radius: 12px;
        padding: 10px 15px;
        border: 2px solid #ff4b93;
        transition: all 0.3s ease;
      }
      .search-bar input:focus {
        border-color: #d90368;
        box-shadow: 0 0 10px rgba(217, 3, 104, 0.2);
        outline: none;
      }

      /* ‚ú® Smooth fade for cards */
      .card {
        transition: all 0.4s ease;
        opacity: 1;
      }
      .card.hidden {
        opacity: 0;
        transform: scale(0.95);
        pointer-events: none;
      }

      /* üïµÔ∏è Highlight match */
      mark {
        background-color: #ffe2ec;
        color: #d90368;
        font-weight: 600;
        border-radius: 4px;
        padding: 0 3px;
      }

      /* üö´ No result message */
      #no-results {
        display: none;
        color: #d90368;
        font-weight: 500;
      }
    </style>
  </head>

  <body class="d-flex flex-column min-vh-100">
    <!-- Header -->
    <header class="d-flex justify-content-between align-items-center p-3 border-bottom">
      <div class="d-flex align-items-center gap-2">
        <img src="../../static/media/sticker.webp" width="50" height="50" alt="Logo" />
        <h1 class="h5 m-0">Egoisty</h1>
      </div>

      <nav>
        <ul class="nav gap-3">
          <li class="nav-item"><a class="nav-link text-dark" href="../welcome/main.html">Home</a></li>
          <li class="nav-item"><a class="nav-link fw-semibold text-danger" href="catalog.html">Catalog</a></li>
          <li class="nav-item"><a class="nav-link text-dark" href="../gallery/gallery.html">Gallery</a></li>
          <li class="nav-item"><a class="nav-link text-dark" href="../FAQ/FAQ.html">FAQ</a></li>
          <li class="nav-item"><a class="nav-link text-dark" href="../../authentication/login/login.html">Sign in</a></li>
          <li class="nav-item"><a class="nav-link text-dark" href="../../authentication/register/register.html">Sign up</a></li>
          <li class="nav-item">
            <a class="nav-link d-flex align-items-center text-dark" href="../cart/cart.html">
              <svg class="me-1" fill="currentColor" viewBox="0 0 24 24" width="20" height="20">
                <path d="M7 4h14l-1.1 8.8H8.9L7 4zm0 0L5.4 2H1m6 2l1.1 8.8v0M9 19.5c0 .8.7 1.5 1.5 1.5s1.5-.7 1.5-1.5-.7-1.5-1.5-1.5S9 18.7 9 19.5zm9.5 0c0 .8.7 1.5 1.5 1.5s1.5-.7 1.5-1.5-.7-1.5-1.5-1.5-1.5.7-1.5 1.5z" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round" />
              </svg>
              Cart <span class="badge bg-danger ms-1" id="cartCount">0</span>
            </a>
          </li>
          <li class="nav-item">
            <button id="global-theme-toggle" class="btn btn-outline-secondary ms-2" title="Toggle Dark Mode">
              <i class="fas fa-moon"></i>
            </button>
          </li>
        </ul>
      </nav>
    </header>

    <!-- Main layout -->
    <main class="container-fluid my-5">
      <div class="row">
        <!-- Sidebar -->
        <aside class="col-md-3 col-lg-2 mb-4 mb-md-0 bg-light p-4 rounded">
          <h2 class="h5 text-danger mb-3">Explore</h2>
          <nav>
            <ul class="list-unstyled">
              <li><a href="#" class="d-block py-2 px-2 rounded text-dark text-decoration-none hover-link">Filters</a></li>
              <li><a href="#" class="d-block py-2 px-2 rounded text-dark text-decoration-none hover-link">Categories</a></li>
              <li><a href="#" class="d-block py-2 px-2 rounded text-dark text-decoration-none hover-link">Brands</a></li>
              <li><a href="#" class="d-block py-2 px-2 rounded text-dark text-decoration-none hover-link">New Arrivals</a></li>
            </ul>
          </nav>
        </aside>

        <!-- Catalog -->
        <section class="col-md-9 col-lg-10">
          <!-- üîç Search bar -->
          <div class="search-bar mb-4 text-center">
            <input type="text" id="product-search" class="form-control mx-auto" style="max-width: 400px;" placeholder="Search for products..." />
            <p id="no-results" class="mt-3">Nothing found üò¢</p>
          </div>

          <div class="row g-4" id="product-list">
            <div class="col-sm-6 col-md-4 col-lg-3 product-item">
              <a href="../headphones.html" class="text-decoration-none text-dark">
                <div class="card text-center p-3 shadow-sm h-100">
                  <div class="display-3">üéß</div>
                  <h3 class="h6 mt-3 mb-1">Premium Wireless Headphones</h3>
                  <p class="text-secondary mb-2">13 980 ‚Ç∏</p>
                  <div class="btn-group" role="group">
                    <button type="button" class="btn buy-btn">Buy</button>
                    <a href="../cart/cart.html" class="btn add-cart-button">Add to Cart</a>
                  </div>
                </div>
              </a>
            </div>

            <div class="col-sm-6 col-md-4 col-lg-3 product-item">
              <a href="../smartphone-case.html" class="text-decoration-none text-dark">
                <div class="card text-center p-3 shadow-sm h-100">
                  <div class="display-3">üì±</div>
                  <h3 class="h6 mt-3 mb-1">Premium Smartphone Case</h3>
                  <p class="text-secondary mb-2">2 490 ‚Ç∏</p>
                  <div class="btn-group" role="group">
                    <button type="button" class="btn buy-btn">Buy</button>
                    <a href="../cart/cart.html" class="btn add-cart-button">Add to Cart</a>
                  </div>
                </div>
              </a>
            </div>

            <div class="col-sm-6 col-md-4 col-lg-3 product-item">
              <a href="../smartwatches.html" class="text-decoration-none text-dark">
                <div class="card text-center p-3 shadow-sm h-100">
                  <div class="display-3">‚åö</div>
                  <h3 class="h6 mt-3 mb-1">Premium Smartwatch Series X</h3>
                  <p class="text-secondary mb-2">4 950 ‚Ç∏</p>
                  <div class="btn-group" role="group">
                    <button type="button" class="btn buy-btn">Buy</button>
                    <a href="../cart/cart.html" class="btn add-cart-button">Add to Cart</a>
                  </div>
                </div>
              </a>
            </div>
          </div>
        </section>
      </div>
    </main>

    <footer class="footer text-center py-3 bg-body-tertiary mt-auto">
      Yerkebulan Zhan, Danial Seit, Tassimov Arsen, Uzbekbay Abilkaiyr
    </footer>

    <!-- ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–ù–´–ô –°–ö–†–ò–ü–¢ –ü–û–ò–°–ö–ê -->
    <script>
      $(document).ready(function () {
        const $searchInput = $("#product-search");
        const $items = $("#product-list .product-item");
        const $noResults = $("#no-results");

        // –°–æ—Ö—Ä–∞–Ω—è–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–µ –Ω–∞–∑–≤–∞–Ω–∏—è —Ç–æ–≤–∞—Ä–æ–≤
        $items.each(function () {
          const $title = $(this).find("h3");
          const originalText = $title.text().trim();
          $title.attr("data-original", originalText);
        });

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è —Å–ø–µ—Ü—Å–∏–º–≤–æ–ª–æ–≤ –≤ RegExp
        function escapeRegExp(string) {
          return string.replace(/[.*+?^${}()|[\]\\]/g, "\\$&");
        }

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤–≤–æ–¥–∞ –≤ –ø–æ–ª–µ –ø–æ–∏—Å–∫–∞
        $searchInput.on("input", function () {
          const query = $(this).val().trim().toLowerCase();
          let visibleCount = 0;

          // –ï—Å–ª–∏ –ø–æ–ª–µ –ø—É—Å—Ç–æ–µ - –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—Å–µ —Ç–æ–≤–∞—Ä—ã
          if (!query) {
            $items.each(function () {
              const $title = $(this).find("h3");
              $title.html($title.attr("data-original"));
              $(this).removeClass("hidden").show();
            });
            $noResults.hide();
            return;
          }

          // –°–æ–∑–¥–∞—ë–º —Ä–µ–≥—É–ª—è—Ä–Ω–æ–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ –¥–ª—è –ø–æ–¥—Å–≤–µ—Ç–∫–∏
          const safeQuery = escapeRegExp(query);
          const regex = new RegExp("(" + safeQuery + ")", "gi");

          // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–∞–∂–¥—ã–π —Ç–æ–≤–∞—Ä
          $items.each(function () {
            const $item = $(this);
            const $title = $item.find("h3");
            const originalText = $title.attr("data-original");
            const lowerText = originalText.toLowerCase();

            if (lowerText.includes(query)) {
              // –¢–æ–≤–∞—Ä –Ω–∞–π–¥–µ–Ω - –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∏ –ø–æ–¥—Å–≤–µ—á–∏–≤–∞–µ–º
              $item.removeClass("hidden").show();
              const highlighted = originalText.replace(regex, "<mark>$1</mark>");
              $title.html(highlighted);
              visibleCount++;
            } else {
              // –¢–æ–≤–∞—Ä –Ω–µ –Ω–∞–π–¥–µ–Ω - —Å–∫—Ä—ã–≤–∞–µ–º
              $item.addClass("hidden").hide();
              $title.html(originalText);
            }
          });

          // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º/—Å–∫—Ä—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ "Nothing found"
          if (visibleCount === 0) {
            $noResults.show();
          } else {
            $noResults.hide();
          }
        });
      });
    </script>

    <!-- Bootstrap + global scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="catalog.js" defer></script>
    <script src="../../global-theme-toggle.js"></script>
    <script src="../../js/advanced-features.js" defer></script>
    <script src="enhanced-catalog.js" defer></script>
  </body>
</html>